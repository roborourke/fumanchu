(function(a){a.fumanchu=function(b,c,f,k){var j=this;a.fumanchu.regex||(a.fumanchu.register("{{","}}"),a.fumanchu.register("__",function(a){return escape(a)}));a.fumanchu.context=c||{};a.fumanchu.fallback=f||c;a.fumanchu.args=k||{};if("undefined"===a.type(b))return"";"function"===a.type(b)&&(b=b.apply(j,[a.fumanchu.context,a.fumanchu.fallback,a.fumanchu.args]));if("object"===a.type(b))if(b.template)a.fumanchu.context=b,b=b.template;else try{b=b.html()}catch(n){}return b.toString().replace(a.fumanchu.regex,
function(b,c,h,f,m,l){var d=a.fumanchu.getpath(h,a.fumanchu.context,a.fumanchu.fallback),e="",g=l||a.fumanchu.templates[h]||a('[data-template="'+h+'"]').html();!a.fumanchu.templates[h]&&g&&(a.fumanchu.templates[h]=g);console.log(c,h,f,m,l);"object"===a.type(d)&&(g||d.template)?(d.template&&(g=d.template),e=j.fumanchu(g,d,a.fumanchu.fallback,k)):"array"===a.type(d)||"object"===a.type(d)?a.each(d,function(b,c){"object"===a.type(c)&&(!c.template&&g&&(c.template=g),a.fumanchu.context=c);e+=j.fumanchu(c,
a.fumanchu.context,a.fumanchu.fallback,{list:d,index:b})}):"function"===a.type(d)?e=d.apply(j,[a.fumanchu.context,a.fumanchu.fallback,k]):"number"===a.type(d)?e=a.fumanchu.numberformat(d,a.fumanchu.fallback):"boolean"===a.type(d)?e=d?"1":"0":"string"===a.type(d)&&(e=d);e=a.fumanchu.delimiters[c].callback(e);return j.fumanchu(e,a.fumanchu.context,a.fumanchu.fallback,a.fumanchu.args)})};a.fumanchu.getpath=function(b,c,f){b=b.split(".");return 4==b.length&&c&&c[b[0]]&&c[b[0]][b[1]]&&c[b[0]][b[1]][b[2]]&&
"undefined"!==a.type(c[b[0]][b[1]][b[2]][b[3]])?c[b[0]][b[1]][b[2]][b[3]]:3==b.length&&c&&c[b[0]]&&c[b[0]][b[1]]&&"undefined"!==a.type(c[b[0]][b[1]][b[2]])?c[b[0]][b[1]][b[2]]:2==b.length&&c&&c[b[0]]&&"undefined"!==a.type(c[b[0]][b[1]])?c[b[0]][b[1]]:1==b.length&&c&&"undefined"!==a.type(c[b[0]])?c[b[0]]:f&&c!==f?a.fn.fumanchu.getpath(b.join("."),f):""};a.fumanchu.regex=null;a.fumanchu.delimiters={};a.fumanchu.register=function(){arguments&&arguments.length&&(open=arguments[0],callback=close=!1,3===
arguments.length?(close=arguments[1],callback=arguments[2]):2===arguments.length&&("string"===a.type(arguments[1])&&(close=arguments[1]),"function"===a.type(arguments[1])&&(callback=arguments[1])),"string"===a.type(open)&&(close||(close=open),"function"!==a.type(callback)&&(callback=function(a){return a}),a.fumanchu.delimiters[open]={open:open,close:close,callback:callback},a.fumanchu.regex=RegExp("("+a.map(a.fumanchu.delimiters,function(a){return a.open}).join("|")+")([a-z0-9.]+)("+a.map(a.fumanchu.delimiters,
function(a){return a.close}).join("|")+")((.*?)(?:\\1)/\\2(?:\\3))?","gim")))};a.fumanchu.templates={};a.fumanchu.numberformat=function(a){return""+a};a(document).ready(function(){a("[data-template]").each(function(){a.fumanchu.templates[a(this).data("template")]=a(this).html()})});a.fn.fumanchu=a.fumanchu})(jQuery);
//# sourceMappingURL=fumanchu.min.js.map
